<form id="getContent">
    <div class="input-group">
        <input type="text" class="form-control" placeholder="URL"
            aria-label="URL" aria-describedby="URL" name="address"
            id="txtAddress">
        <div class="input-group-append">
            <button class="btn btn-primary" type="submit">取得</button>
        </div>
    </div>
    <div class="input-group">
        <input type="text" class="form-control"
            placeholder="Query Selecter" aria-label="query-selecter"
            aria-describedby="query-selecter" id="txtQuery">
        <div class="input-group-append">
            <button class="btn btn-primary" type="button"
                id="btnSetOriginal">抽出</button>
        </div>
    </div>
</form>
<form id="getTranslation">
    <div class="form-group">
        <div class="row">
            <div class="col">
                <textarea class="form-control" id="txtOriginal"
                    name="original" rows="10" placeholder="Original"></textarea>
            </div>
            <div class="col">
                <textarea class="form-control" name="contents"
                    id="txtTranslated" rows="10"
                    placeholder="Translated"></textarea>
            </div>
        </div>
        <button type="button" class="btn btn-primary" id="btnClear">クリア</button>
        <button type="submit" class="btn btn-primary">翻訳</button>
    </div>
</form>
<div id="output"></div>
<script>
	function setContent(response) {
		var div = document.getElementById('output');
		div.innerHTML = response;
	}

	function setTranslation(response) {
		var translated = document.getElementById('txtTranslated');
		translated.value = response;
	}

	function setOriginal() {
		var query = document.getElementById("txtQuery").value;
		var elements = document.querySelectorAll(query);
		var original = document.getElementById("txtOriginal");

		for (var i = 0; i < elements.length; i++) {
			original.value += elements[i].textContent + "\n\n";
		}
	}

	function clear() {
		var address = document.getElementById("txtAddress");
		var query = document.getElementById("txtQuery");
		var original = document.getElementById("txtOriginal");
		var translated = document.getElementById("txtTranslated");
		var htmlOutput = document.getElementById("output");

		address.value = null;
		query.value = null;
		original.value = null;
		translated.value = null;
		htmlOutput.innerHTML = null;
	}

	function getContent(objForm) {
		google.script.run.withSuccessHandler(setContent).getContent(objForm);
	}

	function getTranslation(objForm) {
		google.script.run.withSuccessHandler(setTranslation).getTranslation(
				objForm);
	}

	function preventFormSubmit() {
		var content = document.getElementById('getContent');

		content.addEventListener("submit", function(event) {
			event.preventDefault();
		});

		content.setAttribute("onsubmit", "getContent(this)");

		var btnOriginal = document.getElementById("btnSetOriginal");
		btnOriginal.addEventListener("click", setOriginal);

		var btnClear = document.getElementById("btnClear");
		btnClear.addEventListener("click", clear);

		var translation = document.getElementById("getTranslation");

		translation.addEventListener("submit", function(event) {
			event.preventDefault();
		});

		translation.setAttribute("onsubmit", "getTranslation(this)");
	}

	window.addEventListener('load', preventFormSubmit);
</script>
